@model List<arTWander.Models.Company>

@{
    Layout = null;
}

<!-- breadcrumb starts -->
<nav id="cmnPage_BreadCrumb" class="col-12 mb-4 px-0" aria-label="breadcrumb">
    <ol class="breadcrumb bg-light">
        <li class="breadcrumb-item"><a href="#">訂閱單位</a></li>
    </ol>
</nav>
<!-- breadcrumb ends -->
<!-- 展演單位列表 starts -->
<div class="container ">
    <div class="row row-cols-lg-2 row-cols-xl-3 showlistRow">
        @if (Model.Count > 0)
        {
            foreach (var show in Model)
            {
                @Html.Partial("~/Views/Shared/CommonPartial/Card/_PartialMyCompany.cshtml", show);
            }
        }
        else
        {
            <div class="col-12 mt-5 d-flex align-items-center flex-column">
                <h5 class="d-flex justify-content-center ">
                    @ViewBag.errorMsg
                </h5>
            </div>
        }

        @if (Model.Count > 0)
        {
            <!-- 分頁 starts -->
        <div class="container my-5">
            <div class="row justify-content-center">
                <nav aria-label="Page navigation">
                    <ul class="pagination">
                        <li class="page-item">
                            <a class="page-link text-dark" href="#" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <li class="page-item"><a class="page-link text-dark" href="#">1</a></li>
                        <li class="page-item"><a class="page-link text-dark" href="#">2</a></li>
                        <li class="page-item"><a class="page-link text-dark" href="#">3</a></li>
                        <li class="page-item">
                            <a class="page-link text-dark" href="#" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
        }
        <!-- 分頁 ends -->
    </div>
</div>




<!-- 彈出視窗顯示用戶資訊 -->
<!-- Button trigger modal -->
<!-- Modal -->
<div class="modal fade px-0" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <!-- 控至彈出窗大小 -->
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">展演單位詳細資訊</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <main>
                    <!-- 主內容 -->
                    <!-- ajax導入相關內容 -->
                    <section id="Section" class="w-100">
                        <div id="detailInform">
                        </div>
                    </section>
                </main>
            </div>
        </div>
    </div>
</div>

<script>
    //取得對應customer ID詳細資訊
    $('.Customderform').click(function (event) {
        var companyID = { Id: $(this).find(".companyId").text() };
        var myFormData = new FormData();
        myFormData.append("companyID", JSON.stringify(companyID));
        $.ajax({
            url: '@Url.Action("SubscriptionDetail", "Common")',
            type: 'POST',
            data: myFormData,
            enctype: "multipart/form-data",
            cache: false,
            contentType: false,
            processData: false,
            success: function (data) {
                console.log("Good");
                $('#detailInform').html(data);
            },
            //錯誤訊息
            error: (XMLHttpRequest, textStatus, errorThrown)=>{
              $("#detailInform").innerHTML = "there is something wrong!";
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
            }
         });
    });

    //取得移除company ID詳細資訊
    $('.mySubscriptionDeleteIcon').click(function (event) {
        var companyID = { Id: $(this).find(".companyId").text() };
        var myFormData = new FormData();
        myFormData.append("companyID", JSON.stringify(companyID));
        var galleryName = $(this).find(".galleryName").text();
        $.ajax({
            url: '@Url.Action("DelFromMyGallery", "Common")',
            type: 'POST',
            data: myFormData,
            enctype: "multipart/form-data",
            cache: false,
            contentType: false,
            processData: false,
            success: function (data) {
                console.log("Good");
                Swal.fire({
                    title: '確定移出訂閱清單?',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: '確定移出!'
                }).then((result) => {
                    if (result.isConfirmed) {
                        Swal.fire(
                            '已成功移除!',
                            galleryName+' 已移出訂閱單位',
                            'success'
                        )
                    }
                })
                

            },
            //錯誤訊息
            error: (XMLHttpRequest, textStatus, errorThrown)=>{
            $("#detailInform").innerHTML = "there is something wrong!";
            alert(XMLHttpRequest.status);
            alert(XMLHttpRequest.readyState);
            alert(textStatus);
            }
            });
            });

</script>
